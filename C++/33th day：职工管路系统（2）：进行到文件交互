#include "./head/workerManager.h"

int main(){
    //实例化管理者对象
    WorkerManager wm;
    int choice = 0;


    while(true){
        
        //展示菜单
        wm.showMenu();
        cout << "请输入你的选择：";
        cin >> choice;//接收用户的选项

    
        switch (choice){
            case 0://退出系统
                wm.exitSystem();
                break;

            case 1://添加职工
                wm.addEmp();
                break;

            case 2://显示信息
                break;

            case 3://删除职工
                break;

            case 4://修改信息
                break;

            case 5://查找职工
                break;

            case 6://编号排序
                break;

            case 7://清空文档
                break;

            default:
                system("cls");//清屏操作
                break;
        }
    }

    system("pause");

    return 0;

}




#pragma once
#include <iostream>
#include "worker.h"

//经理类
class Boss: public Worker{
    public:
        Boss(int id, std::string n, int dp);

        //显示个人信息
        void showInfo() override;
        //获取岗位名称
        std::string getDepName() override;
};




#pragma once
#include "worker.h"
#include <iostream>

//员工类
class Employee: public Worker{
    public:
        //构造函数
        Employee(int id, std::string n, int dp);

        //显示个人信息
        void showInfo() override;

        //获取职工岗位名称
        std::string getDepName() override;
};




#pragma once
#include <iostream>
#include "worker.h"

//缁忕悊绫�
class Manager: public Worker{
    public:
        Manager(int id, std::string n, int dp);

        //鏄剧ず涓汉淇℃伅
        void showInfo() override;
        //鑾峰彇宀椾綅鍚嶇О
        std::string getDepName() override;
};





#pragma once
#include <iostream>
#include <string>

class Worker{
    public:
        int ID;//职工编号
        std::string name;//姓名
        int departID;//部门名称编号

        //显示个人信息
        virtual void showInfo() = 0;
        //获取岗位名称
        virtual std::string getDepName() = 0;
        //纯虚析构函数
        virtual ~Worker() = default;
};





#define FILENAME "empFile.txt"
#pragma once   //防止头文件重复包含
#include "worker.h"
#include "employee.h"
#include "manager.h"
#include "boss.h"
#include <iostream>
#include <fstream>
using std::cout, std::cin, std::fstream, std::endl, std::ofstream,
      std::ios;

class WorkerManager{
    public:
        //构造函数
        WorkerManager();
        //析构函数
        ~WorkerManager();

        //展示菜单
        void showMenu();

        //退出系统
        void exitSystem();

        //添加职工
        void addEmp();

        //记录文件中的人数个数
        int EmpNum;

        //员工数组指针
        Worker **EmpArr;

        //标志文件是否为空
        bool fileEmpty;

        //保存文件
        void save();
};





#include "../head/boss.h"

Boss::Boss(int id, std::string n, int dp){
    ID = id;
    name = n;
    departID = dp;
}

void Boss::showInfo(){
    std::cout << "职工编号：" << ID
              << "\n职工姓名：" << name
              << "\n岗位：" << departID
              << "\n岗位职责：管理公司事务\n" << std::endl;
}

std::string Boss::getDepName(){
    return std::string("老板");
}





#include "../head/employee.h"

Employee::Employee(int id, std::string n, int dp){
    ID = id;
    name = n;
    departID = dp;
}

void Employee::showInfo(){
    std::cout << "职工编号：" << ID
              << "\n职工姓名：" << name
              << "\n岗位：" << departID
              << "\n岗位职责：完成经理交给的任务\n" << std::endl;
}

std::string Employee::getDepName(){
    return std::string("普通员工");
}





#include "../head/manager.h"

Manager::Manager(int id, std::string n, int dp){
    ID = id;
    name = n;
    departID = dp;
}

void Manager::showInfo(){
    std::cout << "职工编号：" << ID
              << "\n职工姓名：" << name
              << "\n岗位：" << departID
              << "\n岗位职责：完成老板交给的任务，并下发任务发给员工\n" << std::endl;
}

std::string Manager::getDepName(){
    return std::string("经理");
}





#include "workerManager.h"
#include <fstream>

//构造
WorkerManager::WorkerManager(){
		//初始化人数
		EmpNum = 0;
		
		//初始化数组指针
		EmpArr = NULL;
}

//析构
WorkerManager::~WorkerManager(){
    if (EmpArr != NULL){
        delete[] EmpArr;
        EmpArr = NULL;
    }
}

//菜单界面
void WorkerManager::showMenu(){
    cout << " ———————————————————————"/*16格*/ << endl;
    cout << "|   丨职工管理系统丨    |" << endl;
    cout << "|    1. 添加职工信息    |" << endl;
    cout << "|    2. 显示职工信息    |" << endl;
    cout << "|    3. 删除离职职工    |" << endl;
    cout << "|    4. 修改职工信息    |" << endl;
    cout << "|    5. 查找职工信息    |" << endl;
    cout << "|    6. 按照编号排序    |" << endl;
    cout << "|    7. 清空所有文档    |" << endl;
    cout << "|    0. 退出管理程序    |" << endl;
    cout << " ———————————————————————"/*16格*/ << endl;
}

//退出系统
void WorkerManager::exitSystem(){
    cout << "欢迎下次使用" << endl;
    exit(0);
}

//添加职工
void WorkerManager::addEmp(){
    int addNum = 0;

    cout << "请输入要添加的职工数量: ";
    cin >> addNum;

    if (addNum > 0){
        //重新计算所需空间大小
        int newSize = EmpNum + addNum;
        //开辟新空间
        Worker ** newSpace = new Worker*[newSize];
        
        //将原空间下的内容放入新空间下
        if (EmpArr != NULL){
            for (int i = 0; i < EmpNum; ++i){
                newSpace[i] = EmpArr[i];
            }
        }

        //输入新数据 
        for (int i = 0; i < addNum; ++i){
            int id;
            std::string n;
            int dSelect;

            cout << "请输入第" << i+1 << "个新职工编号：";
            cin >> id;

            cout << "请输入第" << i+1 << "个新职工姓名：";
            cin >> n;

            Worker * w = NULL;

            while (true){
                cout << "请选择该职工的职位" << endl;
                cout << "1.普通职工" << endl;
                cout << "2.经理" << endl;
                cout << "3.老板" << endl;
                cout << "请输入：";
                cin >> dSelect;

                switch(dSelect){
                    case 1:
                        w = new Employee(id, n, 1);
                        break; 
                    
                    case 2:
                        w = new Manager(id, n, 2);
                        break;

                    case 3:
                        w = new Boss(id, n, 3);
                        break;

                    default:
                        cout << "职位选择有误,请重试" << endl;
                        break;
                }
                break;
            }

            //加入新数组
            newSpace[EmpNum + i] = w;
        }

        //释放原空间
        delete[] EmpArr;

        //更改新空间指向
        EmpArr = newSpace;

        //更新职工个数
        ++EmpNum;

        //保存文件
        save();

        //提示信息
        cout << "添加成功" << addNum << "名职工信息" << endl;
    }
    else {
        cout << "输入有误" << endl;
    }

    system("pause");
    system("cls");
}

//保存文件
void WorkerManager::save(){
    ofstream ofs;
    ofs.open(FILENAME, ios::out);

    for (int i = 0; i < EmpNum; ++i){
        ofs << EmpArr[i]->ID << " "
            << EmpArr[i]->name << " "
            << EmpArr[i]->departID << endl;
    }

    ofs.close();
}





